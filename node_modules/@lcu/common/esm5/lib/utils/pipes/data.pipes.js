import { Pipe } from '@angular/core';
import { DatePipe, DecimalPipe, PercentPipe } from '@angular/common';
import { DataPipeConstants } from '../constants/data-pipe.constants';
import { TemperatureConversion } from '../conversion/temperature.conversion';
var DataPipes = /** @class */ (function () {
    function DataPipes() {
    }
    DataPipes.prototype.transform = function (value, args) {
        if (!args) {
            return value;
        }
        /**
         * Return date M/d/YYYY
         */
        if (args.toLowerCase() === DataPipeConstants.PIPE_SHORTDATE) {
            var pipe = new DatePipe('en-US');
            var transformed = pipe.transform(value, DataPipeConstants.DATE_SHORTDATE);
            return transformed;
        }
        /**
         * Return date
         */
        if (args.toLowerCase() === DataPipeConstants.PIPE_DATE) {
            var pipe = new DatePipe('en-US');
            var transformed = pipe.transform(value, DataPipeConstants.DATE_FMT);
            return transformed;
        }
        /**
         * Return date MMM d, y
         */
        if (args.toLowerCase() === DataPipeConstants.PIPE_MEDIUMDATE) {
            var pipe = new DatePipe('en-US');
            var transformed = pipe.transform(value, 'MMM d, y');
            return transformed;
        }
        /**
         * Return date 'EEEE, MMMM d, y'
         */
        if (args.toLowerCase() === DataPipeConstants.PIPE_FULLDATE) {
            var pipe = new DatePipe('en-US');
            var transformed = pipe.transform(value, DataPipeConstants.DATE_FULLDATE);
            return transformed;
        }
        /**
         * Return date from epoch value
         */
        if (args.toLowerCase() === DataPipeConstants.PIPE_EPOCH) {
            var pipe = new DatePipe('en-US');
            var transformed = pipe.transform(value * 1000, DataPipeConstants.DATE_DAY_TIME);
            return transformed;
        }
        /**
         * Return number with decimal
         */
        if (args.toLowerCase() === DataPipeConstants.PIPE_NUMBER) {
            var pipe = new DecimalPipe('en-US');
            var transformed = pipe.transform(value, '1.0-0');
            return transformed;
        }
        /**
         * Return return number with mph appended
         */
        if (args.toLowerCase() === DataPipeConstants.PIPE_MPH) {
            var pipe = new DecimalPipe('en-US');
            var transformed = pipe.transform(value, '1.0-0');
            return transformed + ' mph';
        }
        /**
         * Return percentage
         */
        if (args.toLowerCase() === DataPipeConstants.PIPE_PERCENTAGE) {
            var pipe = new PercentPipe('en-US');
            var transformed = pipe.transform(value);
            return transformed;
        }
        /**
         * Return percentage
         */
        if (args.toLowerCase() === DataPipeConstants.PIPE_PERCENTAGE_DECIMAL) {
            var pipe = new PercentPipe('en-US');
            var transformed = pipe.transform(value, '2.2-2');
            return transformed;
        }
        /**
         * Return percentage with two decimals
         */
        if (args.toLowerCase() === DataPipeConstants.PIPE_DECIMAL_TWO) {
            var pipe = new DecimalPipe('en-US');
            var transformed = pipe.transform(value, '1.2-2');
            return transformed;
        }
        /**
         * Return percentage with four decimals
         */
        if (args.toLowerCase() === DataPipeConstants.PIPE_DECIMAL_FOUR) {
            var pipe = new DecimalPipe('en-US');
            var transformed = pipe.transform(value, '1.4-4');
            return transformed;
        }
        /**
         * Return temperature in fahrenheit, append °F
         */
        if (args.toLowerCase() === DataPipeConstants.PIPE_TEMP_FAHRENHEIT) {
            var pipe = new DecimalPipe('en-US');
            // const temperature = (value * 32) + 1.8;
            var transformed = pipe.transform(value, '1.0-0');
            return transformed + ' °F';
        }
        /**
         * Return temperature in kelvin, append °K
         */
        if (args.toLowerCase() === DataPipeConstants.PIPE_TEMP_KELVIN) {
            var pipe = new DecimalPipe('en-US');
            // const temperature = (value * 32) + 1.8;
            var temperature = TemperatureConversion.FahrenheitToKelvin(value);
            var transformed = pipe.transform(temperature, '1.0-0');
            return transformed + ' °K';
        }
        /**
         * Return temperature in celsius, append °C
         */
        if (args.toLowerCase() === DataPipeConstants.PIPE_TEMP_CELSIUS) {
            var pipe = new DecimalPipe('en-US');
            var temperature = TemperatureConversion.FahrenheitToCelsius(value);
            var transformed = pipe.transform(temperature, '1.0-0');
            return transformed + ' °C';
        }
        /**
         * IF none of the above work, return the original value
         */
        return value;
    };
    DataPipes.decorators = [
        { type: Pipe, args: [{
                    name: 'dataPipes'
                },] }
    ];
    return DataPipes;
}());
export { DataPipes };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YS5waXBlcy5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BsY3UvY29tbW9uLyIsInNvdXJjZXMiOlsibGliL3V0aWxzL3BpcGVzL2RhdGEucGlwZXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLElBQUksRUFBaUIsTUFBTSxlQUFlLENBQUM7QUFDcEQsT0FBTyxFQUFFLFFBQVEsRUFBRSxXQUFXLEVBQUUsV0FBVyxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDckUsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sa0NBQWtDLENBQUM7QUFDckUsT0FBTyxFQUFFLHFCQUFxQixFQUFFLE1BQU0sc0NBQXNDLENBQUM7QUFHN0U7SUFBQTtJQTBKQSxDQUFDO0lBbEpDLDZCQUFTLEdBQVQsVUFBVSxLQUFVLEVBQUUsSUFBVTtRQUM5QixJQUFJLENBQUMsSUFBSSxFQUFFO1lBQ1QsT0FBTyxLQUFLLENBQUM7U0FDZDtRQUVEOztXQUVHO1FBQ0gsSUFBSSxJQUFJLENBQUMsV0FBVyxFQUFFLEtBQUssaUJBQWlCLENBQUMsY0FBYyxFQUFFO1lBQzNELElBQU0sSUFBSSxHQUFHLElBQUksUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQ25DLElBQU0sV0FBVyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxFQUFFLGlCQUFpQixDQUFDLGNBQWMsQ0FBQyxDQUFDO1lBQzVFLE9BQU8sV0FBVyxDQUFDO1NBQ3BCO1FBRUQ7O1dBRUc7UUFDSCxJQUFJLElBQUksQ0FBQyxXQUFXLEVBQUUsS0FBSyxpQkFBaUIsQ0FBQyxTQUFTLEVBQUU7WUFDdEQsSUFBTSxJQUFJLEdBQUcsSUFBSSxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDbkMsSUFBTSxXQUFXLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLEVBQUUsaUJBQWlCLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDdEUsT0FBTyxXQUFXLENBQUM7U0FDcEI7UUFJRDs7V0FFRztR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RSxPQUFPLENBQUMsQ0FBQztZQUV6RCxPQUFPLFdBQVcsR0FBRyxLQUFLLENBQUM7U0FDNUI7UUFHRDs7V0FFRztRQUNILE9BQU8sS0FBSyxDQUFDO0lBQ2YsQ0FBQzs7Z0JBekpGLElBQUksU0FBQztvQkFDSixJQUFJLEVBQUUsV0FBVztpQkFDbEI7O0lBd0pELGdCQUFDO0NBQUEsQUExSkQsSUEwSkM7U0FuSlksU0FBUyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBpcGUsIFBpcGVUcmFuc2Zvcm0gfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgRGF0ZVBpcGUsIERlY2ltYWxQaXBlLCBQZXJjZW50UGlwZSB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XHJcbmltcG9ydCB7IERhdGFQaXBlQ29uc3RhbnRzIH0gZnJvbSAnLi4vY29uc3RhbnRzL2RhdGEtcGlwZS5jb25zdGFudHMnO1xyXG5pbXBvcnQgeyBUZW1wZXJhdHVyZUNvbnZlcnNpb24gfSBmcm9tICcuLi9jb252ZXJzaW9uL3RlbXBlcmF0dXJlLmNvbnZlcnNpb24nO1xyXG5cclxuXHJcbkBQaXBlKHtcclxuICBuYW1lOiAnZGF0YVBpcGVzJ1xyXG59KVxyXG5cclxuLyoqXHJcbiAqIFBpcGVzIGZvciBkYXRhZ3JpZCB2YWx1ZXNcclxuICovXHJcbmV4cG9ydCBjbGFzcyBEYXRhUGlwZXMgaW1wbGVtZW50cyBQaXBlVHJhbnNmb3JtIHtcclxuICB0cmFuc2Zvcm0odmFsdWU6IGFueSwgYXJncz86IGFueSk6IGFueSB7XHJcbiAgICBpZiAoIWFyZ3MpIHtcclxuICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJuIGRhdGUgTS9kL1lZWVlcclxuICAgICAqL1xyXG4gICAgaWYgKGFyZ3MudG9Mb3dlckNhc2UoKSA9PT0gRGF0YVBpcGVDb25zdGFudHMuUElQRV9TSE9SVERBVEUpIHtcclxuICAgICAgY29uc3QgcGlwZSA9IG5ldyBEYXRlUGlwZSgnZW4tVVMnKTtcclxuICAgICAgY29uc3QgdHJhbnNmb3JtZWQgPSBwaXBlLnRyYW5zZm9ybSh2YWx1ZSwgRGF0YVBpcGVDb25zdGFudHMuREFURV9TSE9SVERBVEUpO1xyXG4gICAgICByZXR1cm4gdHJhbnNmb3JtZWQ7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm4gZGF0ZVxyXG4gICAgICovXHJcbiAgICBpZiAoYXJncy50b0xvd2VyQ2FzZSgpID09PSBEYXRhUGlwZUNvbnN0YW50cy5QSVBFX0RBVEUpIHtcclxuICAgICAgY29uc3QgcGlwZSA9IG5ldyBEYXRlUGlwZSgnZW4tVVMnKTtcclxuICAgICAgY29uc3QgdHJhbnNmb3JtZWQgPSBwaXBlLnRyYW5zZm9ybSh2YWx1ZSwgRGF0YVBpcGVDb25zdGFudHMuREFURV9GTVQpO1xyXG4gICAgICByZXR1cm4gdHJhbnNmb3JtZWQ7XHJcbiAgICB9XHJcblxyXG4gICAgXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm4gZGF0ZSBNTU0gZCwgeVxyXG4gICAgICovXHJcbiAgICBpZiAoYXJncy50b0xvd2VyQ2FzZSgpID09PSBEYXRhUGlwZUNvbnN0YW50cy5QSVBFX01FRElVTURBVEUpIHtcclxuICAgICAgY29uc3QgcGlwZSA9IG5ldyBEYXRlUGlwZSgnZW4tVVMnKTtcclxuICAgICAgY29uc3QgdHJhbnNmb3JtZWQgPSBwaXBlLnRyYW5zZm9ybSh2YWx1ZSwgJ01NTSBkLCB5Jyk7XHJcbiAgICAgIHJldHVybiB0cmFuc2Zvcm1lZDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybiBkYXRlICdFRUVFLCBNTU1NIGQsIHknXHJcbiAgICAgKi9cclxuICAgIGlmIChhcmdzLnRvTG93ZXJDYXNlKCkgPT09IERhdGFQaXBlQ29uc3RhbnRzLlBJUEVfRlVMTERBVEUpIHtcclxuICAgICAgY29uc3QgcGlwZSA9IG5ldyBEYXRlUGlwZSgnZW4tVVMnKTtcclxuICAgICAgY29uc3QgdHJhbnNmb3JtZWQgPSBwaXBlLnRyYW5zZm9ybSh2YWx1ZSwgRGF0YVBpcGVDb25zdGFudHMuREFURV9GVUxMREFURSk7XHJcbiAgICAgIHJldHVybiB0cmFuc2Zvcm1lZDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybiBkYXRlIGZyb20gZXBvY2ggdmFsdWVcclxuICAgICAqL1xyXG4gICAgaWYgKGFyZ3MudG9Mb3dlckNhc2UoKSA9PT0gRGF0YVBpcGVDb25zdGFudHMuUElQRV9FUE9DSCkge1xyXG4gICAgICBjb25zdCBwaXBlID0gbmV3IERhdGVQaXBlKCdlbi1VUycpO1xyXG4gICAgICBjb25zdCB0cmFuc2Zvcm1lZCA9IHBpcGUudHJhbnNmb3JtKHZhbHVlICogMTAwMCwgRGF0YVBpcGVDb25zdGFudHMuREFURV9EQVlfVElNRSk7XHJcbiAgICAgIHJldHVybiB0cmFuc2Zvcm1lZDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybiBudW1iZXIgd2l0aCBkZWNpbWFsXHJcbiAgICAgKi9cclxuICAgIGlmIChhcmdzLnRvTG93ZXJDYXNlKCkgPT09IERhdGFQaXBlQ29uc3RhbnRzLlBJUEVfTlVNQkVSKSB7XHJcbiAgICAgIGNvbnN0IHBpcGUgPSBuZXcgRGVjaW1hbFBpcGUoJ2VuLVVTJyk7XHJcbiAgICAgIGNvbnN0IHRyYW5zZm9ybWVkID0gcGlwZS50cmFuc2Zvcm0odmFsdWUsICcxLjAtMCcpO1xyXG4gICAgICByZXR1cm4gdHJhbnNmb3JtZWQ7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm4gcmV0dXJuIG51bWJlciB3aXRoIG1waCBhcHBlbmRlZFxyXG4gICAgICovXHJcbiAgICBpZiAoYXJncy50b0xvd2VyQ2FzZSgpID09PSBEYXRhUGlwZUNvbnN0YW50cy5QSVBFX01QSCkge1xyXG4gICAgICBjb25zdCBwaXBlID0gbmV3IERlY2ltYWxQaXBlKCdlbi1VUycpO1xyXG4gICAgICBjb25zdCB0cmFuc2Zvcm1lZCA9IHBpcGUudHJhbnNmb3JtKHZhbHVlLCAnMS4wLTAnKTtcclxuICAgICAgcmV0dXJuIHRyYW5zZm9ybWVkICsgJyBtcGgnO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJuIHBlcmNlbnRhZ2VcclxuICAgICAqL1xyXG4gICAgaWYgKGFyZ3MudG9Mb3dlckNhc2UoKSA9PT0gRGF0YVBpcGVDb25zdGFudHMuUElQRV9QRVJDRU5UQUdFKSB7XHJcbiAgICAgIGNvbnN0IHBpcGUgPSBuZXcgUGVyY2VudFBpcGUoJ2VuLVVTJyk7XHJcbiAgICAgIGNvbnN0IHRyYW5zZm9ybWVkID0gcGlwZS50cmFuc2Zvcm0odmFsdWUpO1xyXG4gICAgICByZXR1cm4gdHJhbnNmb3JtZWQ7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm4gcGVyY2VudGFnZVxyXG4gICAgICovXHJcbiAgICBpZiAoYXJncy50b0xvd2VyQ2FzZSgpID09PSBEYXRhUGlwZUNvbnN0YW50cy5QSVBFX1BFUkNFTlRBR0VfREVDSU1BTCkge1xyXG4gICAgICBjb25zdCBwaXBlID0gbmV3IFBlcmNlbnRQaXBlKCdlbi1VUycpO1xyXG4gICAgICBjb25zdCB0cmFuc2Zvcm1lZCA9IHBpcGUudHJhbnNmb3JtKHZhbHVlLCAnMi4yLTInKTtcclxuICAgICAgcmV0dXJuIHRyYW5zZm9ybWVkO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJuIHBlcmNlbnRhZ2Ugd2l0aCB0d28gZGVjaW1hbHNcclxuICAgICAqL1xyXG4gICAgaWYgKGFyZ3MudG9Mb3dlckNhc2UoKSA9PT0gRGF0YVBpcGVDb25zdGFudHMuUElQRV9ERUNJTUFMX1RXTykge1xyXG4gICAgICBjb25zdCBwaXBlID0gbmV3IERlY2ltYWxQaXBlKCdlbi1VUycpO1xyXG4gICAgICBjb25zdCB0cmFuc2Zvcm1lZCA9IHBpcGUudHJhbnNmb3JtKHZhbHVlLCAnMS4yLTInKTtcclxuICAgICAgcmV0dXJuIHRyYW5zZm9ybWVkO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJuIHBlcmNlbnRhZ2Ugd2l0aCBmb3VyIGRlY2ltYWxzXHJcbiAgICAgKi9cclxuICAgIGlmIChhcmdzLnRvTG93ZXJDYXNlKCkgPT09IERhdGFQaXBlQ29uc3RhbnRzLlBJUEVfREVDSU1BTF9GT1VSKSB7XHJcbiAgICAgIGNvbnN0IHBpcGUgPSBuZXcgRGVjaW1hbFBpcGUoJ2VuLVVTJyk7XHJcbiAgICAgIGNvbnN0IHRyYW5zZm9ybWVkID0gcGlwZS50cmFuc2Zvcm0odmFsdWUsICcxLjQtNCcpO1xyXG4gICAgICByZXR1cm4gdHJhbnNmb3JtZWQ7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm4gdGVtcGVyYXR1cmUgaW4gZmFocmVuaGVpdCwgYXBwZW5kIMKwRlxyXG4gICAgICovXHJcbiAgICBpZiAoYXJncy50b0xvd2VyQ2FzZSgpID09PSBEYXRhUGlwZUNvbnN0YW50cy5QSVBFX1RFTVBfRkFIUkVOSEVJVCkge1xyXG4gICAgICBjb25zdCBwaXBlID0gbmV3IERlY2ltYWxQaXBlKCdlbi1VUycpO1xyXG4gICAgICAvLyBjb25zdCB0ZW1wZXJhdHVyZSA9ICh2YWx1ZSAqIDMyKSArIDEuODtcclxuICAgICAgY29uc3QgdHJhbnNmb3JtZWQgPSBwaXBlLnRyYW5zZm9ybSh2YWx1ZSwgJzEuMC0wJyk7XHJcblxyXG4gICAgICByZXR1cm4gdHJhbnNmb3JtZWQgKyAnIMKwRic7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm4gdGVtcGVyYXR1cmUgaW4ga2VsdmluLCBhcHBlbmQgwrBLXHJcbiAgICAgKi9cclxuICAgIGlmIChhcmdzLnRvTG93ZXJDYXNlKCkgPT09IERhdGFQaXBlQ29uc3RhbnRzLlBJUEVfVEVNUF9LRUxWSU4pIHtcclxuICAgICAgY29uc3QgcGlwZSA9IG5ldyBEZWNpbWFsUGlwZSgnZW4tVVMnKTtcclxuICAgICAgLy8gY29uc3QgdGVtcGVyYXR1cmUgPSAodmFsdWUgKiAzMikgKyAxLjg7XHJcbiAgICAgIGNvbnN0IHRlbXBlcmF0dXJlID0gVGVtcGVyYXR1cmVDb252ZXJzaW9uLkZhaHJlbmhlaXRUb0tlbHZpbih2YWx1ZSk7XHJcbiAgICAgIGNvbnN0IHRyYW5zZm9ybWVkID0gcGlwZS50cmFuc2Zvcm0odGVtcGVyYXR1cmUsICcxLjAtMCcpO1xyXG5cclxuICAgICAgcmV0dXJuIHRyYW5zZm9ybWVkICsgJyDCsEsnO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJuIHRlbXBlcmF0dXJlIGluIGNlbHNpdXMsIGFwcGVuZCDCsENcclxuICAgICAqL1xyXG4gICAgaWYgKGFyZ3MudG9Mb3dlckNhc2UoKSA9PT0gRGF0YVBpcGVDb25zdGFudHMuUElQRV9URU1QX0NFTFNJVVMpIHtcclxuICAgICAgY29uc3QgcGlwZSA9IG5ldyBEZWNpbWFsUGlwZSgnZW4tVVMnKTtcclxuICAgICAgY29uc3QgdGVtcGVyYXR1cmUgPSBUZW1wZXJhdHVyZUNvbnZlcnNpb24uRmFocmVuaGVpdFRvQ2Vsc2l1cyh2YWx1ZSk7XHJcbiAgICAgIGNvbnN0IHRyYW5zZm9ybWVkID0gcGlwZS50cmFuc2Zvcm0odGVtcGVyYXR1cmUsICcxLjAtMCcpO1xyXG5cclxuICAgICAgcmV0dXJuIHRyYW5zZm9ybWVkICsgJyDCsEMnO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIElGIG5vbmUgb2YgdGhlIGFib3ZlIHdvcmssIHJldHVybiB0aGUgb3JpZ2luYWwgdmFsdWVcclxuICAgICAqL1xyXG4gICAgcmV0dXJuIHZhbHVlO1xyXG4gIH1cclxufVxyXG4iXX0=